function Properties(t){"use strict";if(!(this instanceof Properties))return new Properties(t);var e={},r=["string","number"],i=["string","number","object"],o="Properties",s=0;this.setMode=function(t){if(1!==t&&0!==t)throw new Error("Allowed values for mode are 0, 1.");s=t},this.getMode=function(){return s},this.getName=function(){return o},this.setName=function(t){"string"==typeof t&&(o=t)},this.setStyles=function(t){e.style=t instanceof Properties?t:new Properties(t),e.style.setMode(Properties.MODE_STYLE)},this.setProperty=function(t,r){var i=typeof t,o=typeof r;return-1!==this.getAllowedKeyTypes().indexOf(i)&&-1!==this.getAllowedValueTypes().indexOf(o)?("style"===t?this.setStyles(r):e[t]=r,!0):!1},this.getAllowedKeyTypes=function(){return r},this.getAllowedValueTypes=function(){return i};var n=function(t,e){e=e||"-";var r=new RegExp("^(.*)-(.*$)"),i=t.match(r);return i?[i[1],i[2]]:void 0};this.getProperty=function(t){if("string"==typeof t||"number"==typeof t){if(e.hasOwnProperty(t))return e[t];var r=n(t,"-");return r?this.getPropertyBySide(r[0],r[1]):void 0}};var h=["top","right","bottom","left"];this.getAllowedSides=function(){return h},this.getPropertyBySide=function(t,e){var r=this.getAllowedSides().indexOf(e);if(-1!==r){var i=this.getProperty(t);if(i&&("string"==typeof i||"number"==typeof i))switch(i=i.toString().trim().split(/\s+/),i.length){case 1:return i[0];case 2:return i[r%2];case 3:return i[3>r?r:1];case 4:return i[r]}}},this.dropProperty=function(t){if(e.hasOwnProperty(t)){var r=e[t];return delete e[t],r}},this.dropAllProperties=function(){e={}},this.dropStyleProperty=function(t){if(this.hasStyleProperty(t)){var e=this.getStyles(),r=e.dropProperty(t);return this.setStyles(e),e=this.getStyles(),r}};var y=function(t,e){var r,i,o;"string"==typeof t?o=e.stringToJson(t):t instanceof Properties?o=t.getCore():"object"==typeof t&&(o=t);for(r in o)o.hasOwnProperty(r)&&(i=o[r],"object"==typeof e.getProperty(r)&&"object"==typeof i?e.appendToKey(r,i):e.setProperty(r,i))};this.appendToKey=function(t,e){var r=new Properties(this.getProperty(t));r.appendProperty(e),this.setProperty(t,r)},this.stringToJson=function(t){var e,r,i={},o=t.split(Properties.SEPARATOR_RECORDS);return o.forEach(function(t){var o=t.split(Properties.SEPARATOR_KEY_VALUE);2===o.length&&(r=o[0].trim(),e=o[1].trim(),i[r]=e)}),i},y(t,this),this.appendProperty=function(t){y(t,this)},this.appendStyle=function(t){this.initializeStyle(),this.getStyles().appendProperty(t)},this.initializeStyle=function(){var t="style";if(!this.getProperty(t)){var e=new Properties;e.setMode(Properties.MODE_STYLE),this.setProperty(t,e)}},this.toggleProperty=function(t,e,r){return void 0!==r?void this.setProperty(t,this.hasSet(t,[r])?r:e):this.hasSet(t)?void this.dropProperty(t):void this.setProperty(t,e)},this.hasSet=function(t,e){if(!this.hasProperty(t))return!1;var r=this.getProperty(t);return void 0!==e&&Array.isArray(e)?-1===e.indexOf(r):!0};var p=function(t){if(t instanceof Properties){var e,r,i,o=t.getCore();for(e in o)o.hasOwnProperty(e)&&(r=o[e],this.hasProperty(e)?(i=this.getProperty(e),r instanceof Properties&&i instanceof Properties&&i.suggestProperty(r)):this.setProperty(e,o[e]))}}.bind(this);this.suggestProperty=function(t){var e,r,i,o=typeof t,s=this;if(t instanceof Properties&&p(t),"string"===o&&(e=t.split(";"),e.forEach(function(t){var e=t.split(":");2===e.length&&(r=e[0].trim(),i=e[1].trim(),s.hasProperty(r)||s.setProperty(r,i))})),"object"===o)for(r in t)t.hasOwnProperty(r)&&(s.hasProperty(r)||s.setProperty(r,t[r]))},this.hasProperty=function(t){var e=this.getCore();return e&&"function"==typeof e.hasOwnProperty&&e.hasOwnProperty(t)},this.propNum=function(){return Object.keys(e).length},this.getCore=function(){var t,r={};for(t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r},this.isTheSameAs=function(t){if(!(t instanceof Properties))return!1;var e=this.getCore(),r=t.getCore(),i=this.propNum(),o=t.propNum();if(i!==o)return!1;var s=Object.keys(e);return s.every(function(t){return e[t]===r[t]})},this.clone=function(){var t,e,r,i=window[this.getName()],o=this.getCore();t="function"==typeof i?new i:new Properties;for(e in this)this.hasOwnProperty(e)&&(r=this[e],t[e]=r&&"function"==typeof r.clone?r.clone():r);for(e in o)o.hasOwnProperty(e)&&t.setProperty(e,o[e]);return t},this.isEmpty=function(){var t=this.getCore();return!t||0===Object.keys(t).length},this.toString=function(){var t,r,i=[],o=Object.keys(e),s=this.getMode();return t=1===s?": ":'="',r=1===s?";":'"',o.forEach(function(o){var n,h,y=e[o];if(null!==y)switch(h=typeof y){case"object":"function"==typeof y.toString&&(n=y.toString());break;case"number":n=y.toString()+(1===s?"px":"");break;default:n=y}"string"==typeof n&&n.length>0&&i.push(o.toString()+t+n+r)}),i.join(" ")},this.load=function(t){var e,r,i,o,s=t.length;for(e=0;s>e;e++)r=t[e].nodeName.trim(),i=t[e].nodeValue.trim(),o=parseFloat(i),o.toString()===i&&(i=o),this.setProperty(r,i);return!0},this.hasStyles=function(){return this.hasProperty("style")},this.getStyles=function(){return this.getProperty("style")},this.hasStyleProperty=function(t){return this.hasStyles()&&this.getStyles().hasProperty(t)},this.setStyleProperty=function(t,e){this.initializeStyle(),this.getStyles().setProperty(t,e)},this.getStyleProperty=function(t){return this.hasStyles()?this.getStyles().getProperty(t):void 0},this.getBorderInfo=function(){var t={};return t.width=this.getProperty("border-width")||0,t.style=this.getProperty("border-style")||"none",this.hasProperty("border-color")&&(t.color=this.getProperty("border-color")),t},this.decorateElement=function(t){if("function"==typeof t.setAttribute){var e=this.getCore(),r=Object.keys(e);r.forEach(function(r){t.setAttribute(r,e[r])})}},this.setWidth=function(t){this.initializeStyle(),this.setProperty("width",t),this.setStyleProperty("width",t)},this.getWidth=function(){var t="width";return this.hasStyleProperty(t)?this.getStyleProperty(t):this.hasProperty(t)?this.getProperty(t):void 0},this.loadNodeProperties=function(t){var e=t.attributes;e&&this.load(e)},this.setBorder=function(t){var e,r,i,o=1,s="#000001",n="solid";void 0===t&&(t={width:o,color:s,style:n}),e=t.width||o,r=t.color||s,i=t.style||n,this.setStyleProperty("border-width",e),this.setStyleProperty("border-color",r),this.setStyleProperty("border-style",i),this.setProperty("border",e)},this.getBorder=function(){var t={},e="border-style",r="border-width",i="border-color";return t.style=this.hasStyleProperty(e)?this.getStyleProperty(e):"none","none"!==t.style&&(t.width=this.hasStyleProperty(r)?this.getStyleProperty(r):0,0!==t.width&&this.hasStyleProperty(i)&&(t.color=this.getStyleProperty(i))),t},this.removeBorder=function(){this.hasStyleProperty("border-width")&&this.dropStyleProperty("border-width"),this.hasStyleProperty("border-color")&&this.dropStyleProperty("border-color"),this.setStyleProperty("border-style","none"),this.hasProperty("border")&&this.dropProperty("border")},this.shrinkBy=function(t){if(void 0!==t&&this.hasProperty("width")){var e=new Unit(this.getWidth());if("number"==typeof t){var r=e.getValue()-t;return void this.setWidth(r)}if("string"==typeof t){var i,o=new Unit(t);try{i=e.sub(o)}catch(s){throw new Error("Can not shrink: units of measurement do not coincide.")}this.setWidth(i.getValue())}}},this.template=function(){var t,e,r,i,o,s=["string","number"],n=this.getCore(),h={};if("object"!=typeof n)return h;for(t=Object.keys(n),o=t.length,i=0;o>i;i++)e=n[t[i]],-1!==s.indexOf(typeof e)?h[t[i]]=e:e instanceof Properties&&(r=e.template(),Object.keys(r).length>0&&(h[t[i]]=r));return h}}Object.defineProperty(Properties,"MODE_ATTRIBUTE",{value:0,writable:!1}),Object.defineProperty(Properties,"MODE_STYLE",{value:1,writable:!1}),Object.defineProperty(Properties,"SEPARATOR_RECORDS",{value:";",writable:!1}),Object.defineProperty(Properties,"SEPARATOR_KEY_VALUE",{value:":",writable:!1});