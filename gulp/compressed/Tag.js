function Tag(t){"use strict";if(!(this instanceof Tag))return new Tag;var e=t||null,n="Tag";this.getTag=function(){return e},this.setTag=function(t){if(void 0!==t){var n=typeof t;"string"===n?e=t:"number"===n&&(e=t.toString())}};var r=new Properties,i=new Content,o=null,s=new Unit;this.setUnitWorker=function(t){t&&(s=t)},this.getUnitWorker=function(){return s},this.getMarker=function(){return o},this.setMarker=function(t){"string"==typeof t&&""!==t&&(o=t)},this.setProperties=function(t){r=t instanceof Properties?t.clone():new Properties(t)},this.getProperties=function(){var t=r.clone();return t},this.setStyles=function(t){r.setStyles(t)},this.getStyles=function(){return r.getStyles()},this.setContent=function(t){i=t instanceof Content?t:new Content(t)},this.getContent=function(){return i.clone()},this.getName=function(){return n},this.setName=function(t){"string"==typeof t&&(n=t)},this.appendStyle=function(t){r.appendStyle(t)},this.appendAttributes=function(t){console.log("This method is deprecated. Redirected to appendProperties()"),r.appendProperties(t)},this.appendProperties=function(t){r.appendProperty(t)},this.appendStyleToElemAt=function(t,e){i.appendStyleToElemAt(t,e)},this.getStyleProperty=function(t){var e=this.getStyles();return e?e.getProperty(t):void 0},this.setStyleProperty=function(t,e){return r.setStyleProperty(t,e)},this.getProperty=function(t){return this.getProperties().getProperty(t)},this.setProperty=function(t,e){r.setProperty(t,e)},this.hasProperty=function(t){var e=this.getProperties();return e&&e.hasProperty(t)},this.hasStyleProperty=function(t){var e=this.getStyles();return void 0!==e&&null!==e&&e.hasProperty(t)},this.dropProperty=function(t){return this.hasProperty(t)?r.dropProperty(t):void 0},this.dropStyleProperty=function(t){return this.hasStyleProperty(t)?this.getStyles().dropProperty(t):void 0},this.setWidth=function(t){void 0!==t&&r.setWidth(t)},this.getWidth=function(){var t=this.getProperties();return t?t.getWidth():void 0},this.getWidthValue=function(){var t=this.getWidth();if(void 0!==t){var e=parseFloat(t);if(!isNaN(e))return e}},this.getElements=function(){var t=this.getContent();return t?t.getElements():void 0},this.setElements=function(t){Array.isArray(t)&&i.setElements(t)},this.getElem=function(t){return this.getContent().getElem(t)},this.getFirst=function(){return this.getContent().getFirst()},this.getLast=function(){return this.getContent().getLast()},this.insertElemAt=function(t,e){i.insertElemAt(t,e)},this.appendElem=function(t){i.appendElem(t)},this.length=function(){return this.getContent().length()},this.dropElemAt=function(t){return i.dropElemAt(t)},this.dropFirst=function(){i.dropFirst()},this.dropLast=function(){i.dropLast()},this.openingTag=function(){var t,e=this.getTag();return"string"==typeof e&&e.length>0?(t=this.getProperties(),t=t&&"function"==typeof t.toString?t.toString():"",t.length>0&&(t=" "+t),"<"+e+t+">"):void 0},this.closingTag=function(){var t=this.getTag();return"string"==typeof t&&t.length>0?"</"+t+">":void 0},this.toHtml=function(){var t,e=this.getTag(),n=this.openingTag(),r=this.closingTag(),i=this.getContent().toHtml();return t="string"==typeof e&&e.length>0?n+i+r:"<!-- tag name is missing -->"},this.toText=function(){return this.getContent().toText()},this.isEmpty=function(){return this.getProperties().isEmpty()&&this.getContent().isEmpty()},this.flushContent=function(){i.flush()},this.flushProperties=function(){r=new Properties},this.trim=function(){i.trim()},this.appendElemIfNotEmpty=function(t){i.appendElemIfNotEmpty(t)},this.clone=function(){var t,e,n,r=window[this.getName()];t="function"==typeof r?new r:new Tag;for(e in this)this.hasOwnProperty(e)&&(n=this[e],t[e]=n&&"function"==typeof n.clone?n.clone():n);return t},this.loadFromElement=function(t){var e,n,r,o,s,h,a=!1,l=!1,p=[];if(t instanceof Element){for(n=t.childNodes,h=n.length,this.setTag(t.tagName.toLowerCase()),o=t.attributes,o&&(e=this.getProperties(),a=e.load(o),this.setProperties(e)),s=0;h>s;s++)r=n.item(s),p.push(r);l=i.load(p)}return a&&l},this.loadIntoElement=function(t){var e,n,r=this.getProperties().getCore();for(e in r)if(r.hasOwnProperty(e)){n=r[e],n&&"function"==typeof n.toString&&(n=n.toString());try{t.setAttribute(e,n)}catch(i){console.log(i.name+" occurred when loading properties on the element: "+i.message)}}},this.extractFromTemplate=function(t,e){var n={};return e.forEach(function(e){t.hasOwnProperty(e)&&(n[e]=t[e])}),n},this.toNode=function(){var t=document.createElement(this.getTag());return this.getProperties().decorateElement(t),this.getContent().stickTo(t),t},this.setTitle=function(t){"string"==typeof t&&t.length>0?this.setProperty("title",t):this.dropProperty("title")},this.applyToAll=function(t){i&&"function"==typeof t&&i.applyToAll(t)},this.mark=function(t){this.setMarker(t),this.setProperty(t,this.getName())},this.unmark=function(){var t=this.getMarker();t&&(this.dropProperty(t),o=null)},this.shrinkBy=function(t){r.shrinkBy(t)},this.setStylePropertyToAll=function(t,e){var n,r,i=new Content,o=this.length();for(n=0;o>n;n++)r=this.getElem(n),r.setStyleProperty(t,e),i.appendElem(r);this.setContent(i)},this.setStylePropertyOfRange=function(t,e,n){if(!Array.isArray(n)&&null!==n&&void 0!==n)throw new Error("Range must be an array!");var r,i,o=new Content,s=this.length(),h=null===n||void 0===n;for(r=0;s>r;r++)i=this.getElem(r),(h||-1!==n.indexOf(r))&&i.setStyleProperty(t,e),o.appendElem(i);this.setContent(o)},this.getStylePropertyOfRange=function(t,e){if(!Array.isArray(e)&&null!==e&&void 0!==e)throw new Error("Range must be an array!");if(Array.isArray(e)&&0===e.length)return null;var n=this.length();if(null===e||void 0===e){e=[];var r;for(r=0;n>r;r++)e.push(r);return this.getStylePropertyOfRange(t,e)}var i,o;return e=e.map(function(t){return 0>t?n+t:t}),e.forEach(function(e){try{o=this.getElem(e).getStyleProperty(t)}catch(n){console.log("Error ("+n.message+") when retrieving style property "+t+" of element n. "+e),o=null}if(void 0===i)i=o;else if(i!==o)return null}.bind(this)),i},this.template=function(){var t={},e=this.getTag(),n=this.getContent(),r=this.getProperties();if(e&&(t.tag=e),r){var i=r.template();"object"==typeof i&&0!==Object.keys(i).length&&(t.root=i)}if(n){var o=n.template();Array.isArray(o)&&o.length>0&&(t.children=o)}return t},this.loadTemplate=function(t){this.loadProperTemplate(t),this.loadChildTemplates(this.extractChildTemplates(t))},this.loadProperTemplate=function(t){var e=this.getProperties();e.appendProperty(this.extractProperTemplate(t)),this.setProperties(e)},this.loadChildTemplates=function(t){var e=this.getContent();e&&(e.loadTemplateBunch(t),this.setContent(e))},this.extractProperTemplate=function(t){return t.root||{}},this.extractChildTemplates=function(t){return t.children||[]}}Tag.prototype.characteristicFunction=function(t){return t instanceof Node};